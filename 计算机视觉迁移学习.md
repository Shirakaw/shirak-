**计算机视觉迁移学习教程**

### 前言

关于迁移学习最早的了解来自导师的论文《基于迁移学习与残差网络的矿工不安全行为识别》，，这节学习计算机视觉用作迁移学习

### 什么是迁移学习？
通俗来讲，迁移学习就是运用及有的知识来学习新的知识，核心是找到已有知识和新知识之间的相似性。从机器学习角度来说就是把已训练好的模型参数迁移到新的模型来帮助新模型训练。说白了就是学习造轮子快速满足需求。

### 如何使用？
迁移学习需要满足三个要求，预训练模型API，重用模型，模型微调
* 预训练模型是指其他科研组织或团体研究相似问题时构建的训练模型。该模型通常选择非常大的数据集作为训练集。并且该模型必须公开，才能使用
* 冲用模型通过一些特定的源来加载训练的模型。
	* **TensorFlow Hub**
    * **Keras Applications**
    * **PyTorch Hub**  
    使用上述深度学习库，可以根据自己的意愿调整网络层和权重。
 * 模型微调：参考- [TORCHVISION目标检测微调教程](https://mp.weixin.qq.com/s/s18nVND3PhyYiaO_ioA9ZA)如何对特定类进行微调或者修改模型以添加不同主干，将帮助构建的模型更能适用于我们的问题，达到更高的精度。在我们将自定义层添加到预先训练好的模型之后，可以使用特殊的损失函数和优化器来配置，并通过额外的训练进行微调。
 
 ### 计算机视觉下的迁移学习主要场景
 * 微调**convnet** ：我们使用预训练网络进行初始化而不是随机初始化
 * **ConvNet** 作为固定特征提取器：在这里我们将冻结所有网络的权重（最后一层除外）。使用一个随机权重的层替换最后一个连接层，并且只训练这一层
```python
import tensorflow as tf

x = tf.random_normal([5,3])
m = 4
k = 3
d = 3

W = tf.Variable(tf.random_normal(shape=[d, m, k])) # 3*4*3
b = tf.Variable(tf.random_normal(shape = [m, k])) # 4*3
dot_z = tf.tensordot(x, W, axes=1) + b # 5 * 4 * 3
print(dot_z)
z = tf.reduce_max(dot_z, axis=2) # 5 * 4
print(z)

with tf.Session() as sess:
    sess.run(tf.global_variables_initializer())
    print(sess.run([x,dot_z,z]))
```

#### 推荐阅读

- [微分算子法](https://mp.weixin.qq.com/s/yz3x4JtgnC0lSSOLrBp5lA)
- [使用PyTorch构建神经网络模型进行手写识别](https://mp.weixin.qq.com/s/TPPYYOxRWuQMLEH9Mkeo-g)
- [使用PyTorch构建神经网络模型以及反向传播计算](https://mp.weixin.qq.com/s/aOGm3rQuA6ASBPPt8IiivA)
- [如何优化模型参数，集成模型](https://mp.weixin.qq.com/s/kBUuY12T6Sse4coYYMzlQA)
- [TORCHVISION目标检测微调教程](https://mp.weixin.qq.com/s/s18nVND3PhyYiaO_ioA9ZA)

![](https://cdn.jsdelivr.net/gh/filess/img2@main/2021/08/04/1628081548426-51138395-7cc1-4579-a0f0-dc4195c4ea0b.png)




